CREATE SCHEMA IF NOT EXISTS `CUSTOMER` DEFAULT CHARACTER SET utf8;

USE `CUSTOMER`;

DROP TABLE IF EXISTS `CUSTOMER`.`CUSTOMERS_JOIN_ADDRESSES`;

CREATE TABLE `CUSTOMER`.`CUSTOMERS_JOIN_ADDRESSES` (
  `ID` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,

  -- Metadata columns --
  `CREATED_DATE` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  `CREATED_BY` VARCHAR(100),
  `CREATED_SOURCE` VARCHAR(100),
  `LAST_MODIFIED_DATE` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `LAST_MODIFIED_BY` VARCHAR(100),
  `LAST_MODIFIED_SOURCE` VARCHAR(100),
  `STATUS` VARCHAR(50),
  `VERSION` INT,

  -- Relationship columns --
  `CUSTOMER_ID` BIGINT UNSIGNED,
  `ADDRESS_ID` BIGINT UNSIGNED,

  -- Constraint --
  CONSTRAINT `FK_CUSTOMER` FOREIGN KEY (`CUSTOMER_ID`) REFERENCES `CUSTOMER`.`CUSTOMERS` (`ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `FK_ADDRESS` FOREIGN KEY (`ADDRESS_ID`) REFERENCES `CUSTOMER`.`ADDRESSES` (`ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  PRIMARY KEY (`ID`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
